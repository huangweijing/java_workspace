package homework;

public class TrappingRainWater {

	public static void main(String[] args) {
				
		Integer[] intArray1 = new Integer[]{0,1,0,2,1,0,1,3,2,1,2,1};
		Integer[] intArray2 = new Integer[]{1,3,2,4,3,4};
		Integer[] intArray3 = new Integer[]{0,8,0,1,4};
		Integer[] intArray4 = new Integer[]{4,-2,8,0,1};
		Integer[] intArray5 = new Integer[]{1,0,7,0,1};
		Integer[] intArray6 = new Integer[]{0,1,3,2,1};
		Integer[] intArray7 = new Integer[]{0,1,-1,-2,1};
		Integer[] intArray8 = new Integer[]{0,1,-1,-2,1};
		System.out.println(solution(intArray1));//6
		System.out.println(solution(intArray2));//1
		System.out.println(solution(intArray3));//7
		System.out.println(solution(intArray4));//7
		System.out.println(solution(intArray5));//2
		System.out.println(solution(intArray6));//0
		System.out.println(solution(intArray7));//5
		System.out.println(solution(intArray8));//5
	}
	
	public static Integer solution(Integer[] intArray) {
		Integer result = 0; 
		Integer hightsOfBlocks = 0; //各ブロックの高さ、つまり、intArray[i]の；
		//以下はintArrayのindexを表示してくれるものを作るため、intArrayと同じLさのInteger型Array；
		Integer index = 0;
		Integer[] indexArray = new Integer[intArray.length];
		for(int i=0; i<intArray.length; i++) {
			indexArray[i] = i;
		}
		//以上はintArrayのindexを表示してくれるものを作るため、intArrayと同じLさのInteger型Array；
		Integer indexOfMax1 =indexOfMax(intArray);//indexOfMaxメソ`ドを使って、intArrayの中のmaxのindexをリラ`ンする；
		if(indexOfMax1!=0) { //intArray[0]がmaxかどうかを判断する；maxじゃない龊稀maxが出てくるまで、右が自分より低い龊悉稀ずっと右をていく；
			Integer leftBlock = intArray[0];
			for(int i=1; i<intArray.length; i++) {
				if(intArray[i] > leftBlock) {
					result = result + (i-index-1)*leftBlock-hightsOfBlocks;//右が自分より高い龊稀つまり、水をAめられるということ、なのでどれだけAまるかを算出；
					index = i;
					hightsOfBlocks = 0;
					if(indexOfMax1==i) {
						break;//ここでmaxが出てきたため、これからの右は全部このmaxより低いため、I理法が浃铯耄护胜韦恰if文を出て、次のwhileル`プに入る；
					}else {
						leftBlock = intArray[i];
					}
				}else {
					hightsOfBlocks = hightsOfBlocks+intArray[i];
				}
			}
		}
		//ここからは、maxの右趣摔膜いI理する；
		while(index<intArray.length-1) {	
			//まずはこの部分（新しいArrayを作って、currentのmaxの右趣蛉部これに入れる；目的は、この中から一番高いブロック（次のmax）を探すこと；
			Integer[] subArray = new Integer[(intArray.length-1) - index];
			for(int i=index+1; i<intArray.length; i++) {
				subArray[i-(index+1)] = intArray[i];
			}
			//以上で、新しいArrayを作って、currentのmaxの右趣蛉部それに入れた；
			Integer indexOfMax2 = indexOfMax(subArray);//この中から一番高いブロック（次のmax）を探しだす；
			if(indexOfMax2==0) {//maxのindexが０だというのは、前のmaxの次にすぐ次のmaxであること；この龊稀この二つのブロックのgにず溜まらない；
				index=index+1;
			}else {//前のmaxと次のmaxのgに、水が溜まっているので、これを算出する；
				for(int i=0; i<indexOfMax2; i++) {
					hightsOfBlocks = hightsOfBlocks+subArray[i];
				}
				result = result +indexOfMax2*subArray[indexOfMax2]-hightsOfBlocks;
				hightsOfBlocks=0;
				index=index+indexOfMax2+1;
			}
		}
		return result;
	}

	public static Integer indexOfMax(Integer[] intArray) {
		Integer max = intArray[0];
		Integer indexOfMax = 0;
		for(int i=1; i<intArray.length; i++) {
			if(intArray[i]>max) {
				max  =  intArray[i];
				indexOfMax = i;
			}
		}
		return indexOfMax;

	}

}
